<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <link rel="stylesheet" type="text/css" href="/static/stylepro.css" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet" />
        <title>Document</title>
    </head>
    <body>
      <script>
        {% if mensaje != None and csv %}
	    alert("{{mensaje}}");
	let lista = [];
	let productos = {};
	{% for i in csv %}
	productos= {codigo_producto : "{{i.codigo_producto}}", nombre_producto : "{{i.nombre_producto}}", nitproveedor : "{{i.nitproveedor}}", precio_compra : "{{i.precio_compra}}", ivacompra : "{{i.ivacompra}}", precio_venta : "{{i.precio_venta}}"};
	lista.push(productos);
	{% endfor %}
	let http = new XMLHttpRequest();
	for (let i = 0;i < lista.length;i++) {
		  let codigo_producto = lista[i].codigo_producto;
		  let nombre_producto = lista[i].nombre_producto;
		  let nitproveedor = lista[i].nitproveedor;
		  let precio_compra = lista[i].precio_compra;
		  let ivacompra = lista[i].ivacompra;
		  let precio_venta = lista[i].precio_venta;
		  const producto = {
		      codigo_producto : codigo_producto,
		      nombre_producto : nombre_producto,
		      nitproveedor : nitproveedor,
		      precio_compra : precio_compra,
		      ivacompra : ivacompra,
		      precio_venta : precio_venta
			  };
		  let options = {
		      mode : "cors",
		      method : "POST",
		      body : JSON.stringify(producto),
		      headers : {
			    "Content-type" : "application/json",
			    'Access-Control-Allow-Origin': '*'
			      }
			  }
		  fetch("http://localhost:8001/api/productos/", options)
		    .then(res => res.json())
		    .then(result => console.log(result));
		}
	{% elif mensaje != None %}
	  alert("{{mensaje}}");
        {% endif %}
      </script>
        <div class="sidebar close">
            <div class="logo-details">
                <i class="bx bxs-shopping-bags"></i>
                <span class="logo_name">TiendaGenerica</span>
            </div>
            <ul class="nav-links">
                <li>
                    <a href="{%url "productos"%}" >
                        <i class='bx bx-cart'></i>
                        <span class="link_name">Productos</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="{%url "productos"%}" >Productos</a></li>
                    </ul>
                </li>
                <li>
                    <a href="{% url "clientes" %}">
                        <i class='bx bxs-group' ></i>
                        <span class="link_name">Clientes</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="{% url "clientes" %}">Clientes</a></li>
                    </ul>
                </li>
                <li>
                    <li>
                        <a href="{% url 'proveedores' %}">
                            <i class='bx bx-store-alt'></i>
                            <span class="link_name">Proveedores</span>
                        </a>
                        <ul class="sub-menu blank">
                            <li><a class="link_name" href="{% url 'proveedores' %}">Proveedores</a></li>
                        </ul>
                </li>
                <li>
                    <a href="{% url 'ventas' %}">
                        <i class='bx bxs-book' ></i>
                        <span class="link_name">Ventas</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="{% url 'ventas' %}">Ventas</a></li>
                    </ul>
                </li>
                <li>
                    <a href="{%url 'reportes'%}">
                        <i class='bx bxs-book-content' ></i>
                        <span class="link_name">Reportes</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="{%url 'reportes'%}">Reportes</a></li>
                    </ul>
                </li>
                <li>
                    <a href="Empleado.html" target="myFrame">
                        <i class="bx bx-world"></i>
                        <span class="link_name">Consolidacion</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="Empleado.html" target="myFrame">Consolidacion</a></li>
                    </ul>
                </li>
                <li>
                    <div class="profile-details">
                        <div class="profile-content">
                            <img src="/static/img/avatar.svg" alt="profile" />
                        </div>
                        <div class="name-job">
                            <div class="profile_name">adminInicial</div>
                            <div class="job">Developer</div>
                        </div>
                        <i class="bx bxs-log-out"></i>
                    </div>
                </li>
            </ul>
        </div>
        <section class="home-section">
            <div class="home-content">
                <i class="bx bx-menu-alt-left"></i>
                <span class="text">Menu</span>
            </div>
            <div id="productos">
                <form method="POST" >
                    <div class="ctnp">
                        {% csrf_token %}
                        <table>
                            <tr class="examinar">
                                <td><label for="archivo">Nombre del Archivo</label></td>
                                <td><input type="file" id="archivo" name="fileupload" accept="text/csv" /></td>
                                <td class="botones"><input type="submit" name="boton" value="Examinar" formaction = "{% url 'leer' %}" /></td>
                            </tr>
                    </div>
                    <div class="btnop">
                        <tr class="cargar">
                            <td class="botones"><input type="submit" name="boton" value="Cargar" formaction="{%url 'importar' %}" /></td>
                        </tr>
                    </div>
                    </table>
                </form>
            </div>
        </section>
        <script>
            let arrow = document.querySelectorAll(".arrow");
            for (var i = 0; i < arrow.length; i++) {
                arrow[i].addEventListener("click", (e) => {
                    let arrowParent = e.target.parentElement.parentElement;
                    arrowParent.classList.toggle("showMenu");
                });
            }
            let sidebar = document.querySelector(".sidebar");
            let sidebarBtn = document.querySelector(".bx-menu-alt-left");
            console.log(sidebarBtn);
            sidebarBtn.addEventListener("click", () => {
                sidebar.classList.toggle("close");
            });
        </script>

    </body>
</html>
